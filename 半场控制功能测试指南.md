# åŠåœºæ§åˆ¶åŠŸèƒ½æµ‹è¯•æŒ‡å—

## åŠŸèƒ½æ¦‚è¿°

æ ¹æ®åç«¯çš„åŠåœºæ§åˆ¶é€»è¾‘ï¼Œå‰ç«¯ç°åœ¨å®ç°äº†æ¨æ†çš„åŠåœºæ§åˆ¶åŠŸèƒ½ï¼š

- **å·¦åŠåœºï¼ˆx < 21.5cmï¼‰**: åªæœ‰pusherAï¼ˆpaddle 0ï¼‰åº”è¯¥å¯è§
- **å³åŠåœºï¼ˆx >= 21.5cmï¼‰**: åªæœ‰pusherBï¼ˆpaddle 1ï¼‰åº”è¯¥å¯è§
- å½“æ¨æ†è¶Šè¿‡åŠåœºæ—¶ï¼Œä¼šè‡ªåŠ¨å˜ä¸ºåŠé€æ˜å¹¶ç¼©å°ï¼Œè¡¨ç¤ºä¸åœ¨æ­£ç¡®çš„åŠåœº

## åç«¯é€»è¾‘å¯¹åº”

```python
# åç«¯ä»£ç é€»è¾‘
if uv[0] < 0.5 and not paddle_detected_by_hand[0]:  # å·¦åŠåœº
    paddle_uvs[0] = self.smooth_uv(self.wrist_history[0], uv, self.max_history_len)
    paddle_centers_px[0] = (x, y)
    used_indices.add(idx)
    paddle_detected_by_hand[0] = True
elif uv[0] >= 0.5 and not paddle_detected_by_hand[1]:  # å³åŠåœº
    paddle_uvs[1] = self.smooth_uv(self.wrist_history[1], uv, self.max_history_len)
    paddle_centers_px[1] = (x, y)
    used_indices.add(idx)
    paddle_detected_by_hand[1] = True
```

## å‰ç«¯å®ç°

### 1. åŠåœºæ£€æµ‹é€»è¾‘

```javascript
isPusherInCorrectHalf(pusherName, position) {
    const centerX = this.halfCourt.centerX; // 21.5cm
    
    if (pusherName === 'pusherA') {
        // PusherA (paddle 0) should be in left half (x < centerX)
        return position.x < centerX;
    } else if (pusherName === 'pusherB') {
        // PusherB (paddle 1) should be in right half (x >= centerX)
        return position.x >= centerX;
    }
    
    return true;
}
```

### 2. å¯è§æ€§æ§åˆ¶

```javascript
updatePusherVisibility(pusherName) {
    const element = this[pusherName];
    const state = this.pusherState[pusherName];
    
    if (element && state) {
        if (state.isVisible) {
            element.style.opacity = '1';
            element.style.pointerEvents = 'auto';
            element.style.transform = 'scale(1)';
        } else {
            element.style.opacity = '0.2';
            element.style.pointerEvents = 'none';
            element.style.transform = 'scale(0.8)';
        }
    }
}
```

## æµ‹è¯•æ–¹æ³•

### 1. æµè§ˆå™¨æ§åˆ¶å°æµ‹è¯•

1. æ‰“å¼€ http://localhost:8000
2. æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·
3. åœ¨æ§åˆ¶å°ä¸­è¿è¡Œï¼š

```javascript
// æµ‹è¯•åŠåœºæ§åˆ¶åŠŸèƒ½
hockeyVisualization.testHalfCourtControl();

// æŸ¥çœ‹å½“å‰åŠåœºçŠ¶æ€
console.log(hockeyVisualization.getHalfCourtStatus());
```

### 2. å®æ—¶æ•°æ®æµ‹è¯•

å½“æ¥æ”¶åˆ°MQTTæ•°æ®æ—¶ï¼š

```javascript
// æ¨¡æ‹ŸpusherAè¶Šè¿‡åŠåœº
hockeyVisualization.updatePositions({
    pusher1: { x: 500, y: 200 }, // å³åŠåœº (x > 405)
    pusher2: { x: 300, y: 200 }  // å·¦åŠåœº (x < 405)
});
```

### 3. è§†è§‰æ•ˆæœéªŒè¯

**æ­£å¸¸çŠ¶æ€**ï¼š
- pusherAåœ¨å·¦åŠåœºï¼šå®Œå…¨å¯è§ï¼Œopacity=1ï¼Œscale=1
- pusherBåœ¨å³åŠåœºï¼šå®Œå…¨å¯è§ï¼Œopacity=1ï¼Œscale=1

**è¶Šç•ŒçŠ¶æ€**ï¼š
- pusherè¶Šè¿‡åŠåœºï¼šåŠé€æ˜ï¼Œopacity=0.2ï¼Œscale=0.8
- é¼ æ ‡äº¤äº’è¢«ç¦ç”¨ï¼špointer-events=none

## åæ ‡ç³»ç»Ÿ

### åç«¯åæ ‡ç³»ç»Ÿ
- å°ºå¯¸ï¼š810x420åƒç´ 
- åŠåœºåˆ†ç•Œçº¿ï¼šx = 405åƒç´ 

### å‰ç«¯åæ ‡ç³»ç»Ÿ
- å°ºå¯¸ï¼š43x26cmï¼ˆçœŸå®å°ºå¯¸ï¼‰
- åŠåœºåˆ†ç•Œçº¿ï¼šx = 21.5cm

### è½¬æ¢å…¬å¼
```javascript
const realX = (mqttX / 810) * 43;
const realY = (mqttY / 420) * 26;
```

## åŠŸèƒ½ç‰¹ç‚¹

1. **å¹³æ»‘è¿‡æ¸¡**: ä½¿ç”¨CSS transitionå®ç°0.3ç§’çš„å¹³æ»‘è¿‡æ¸¡
2. **çŠ¶æ€è¿½è¸ª**: è®°å½•æ¯ä¸ªæ¨æ†çš„åŠåœºçŠ¶æ€å’Œå¯è§æ€§
3. **å®æ—¶æ›´æ–°**: æ¯æ¬¡æ¥æ”¶åˆ°MQTTæ•°æ®æ—¶è‡ªåŠ¨æ£€æŸ¥åŠåœºçŠ¶æ€
4. **è§†è§‰åé¦ˆ**: é€šè¿‡é€æ˜åº¦å’Œç¼©æ”¾æä¾›æ¸…æ™°çš„è§†è§‰åé¦ˆ
5. **æ€§èƒ½ä¼˜åŒ–**: åªåœ¨çŠ¶æ€æ”¹å˜æ—¶æ›´æ–°DOM

## æ—¥å¿—è¾“å‡º

```
âœ… pusherA returned to correct half-court
âŒ pusherB crossed to wrong half-court - hiding pusher
ğŸ“ Pusher A updated to: (8.00, 13.00) [MQTT: 154, 210]
```

## è°ƒè¯•ä¿¡æ¯

ä½¿ç”¨ `hockeyVisualization.getHalfCourtStatus()` æŸ¥çœ‹è¯¦ç»†çŠ¶æ€ï¼š

```javascript
{
    pusherA: {
        position: { x: 8, y: 13 },
        isVisible: true,
        isInCorrectHalf: true,
        correctHalf: 'left'
    },
    pusherB: {
        position: { x: 35, y: 13 },
        isVisible: true,
        isInCorrectHalf: true,
        correctHalf: 'right'
    },
    halfCourtCenter: 21.5
}
```

## æ³¨æ„äº‹é¡¹

1. åŠåœºæ§åˆ¶åªåœ¨æ¨æ†ä½ç½®æ›´æ–°æ—¶è§¦å‘
2. çƒï¼ˆpuckï¼‰ä¸å—åŠåœºæ§åˆ¶é™åˆ¶
3. æ¨æ†çš„ä½ç½®ä¿¡æ¯ä»ç„¶ä¼šæ›´æ–°ï¼Œåªæ˜¯è§†è§‰ä¸Šè¢«éšè—
4. æ‹–æ‹½åŠŸèƒ½åœ¨æ¨æ†éšè—æ—¶è¢«ç¦ç”¨

## æµ‹è¯•åœºæ™¯

1. **æ­£å¸¸æ¸¸æˆ**: æ¨æ†åœ¨å„è‡ªåŠåœºå†…ç§»åŠ¨
2. **è¶Šç•Œæ£€æµ‹**: æ¨æ†è¶Šè¿‡ä¸­çº¿æ—¶çš„å¤„ç†
3. **è¿”å›æ£€æµ‹**: æ¨æ†è¿”å›æ­£ç¡®åŠåœºæ—¶çš„æ¢å¤
4. **å®æ—¶æ•°æ®**: ç»“åˆMQTTæ•°æ®æµçš„å®æ—¶æµ‹è¯• 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Air_Hockey Assistant</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/responsive.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div id="app">
        <header class="header">
            <div class="container">
                <h1 class="logo">
                    <span class="logo-icon">üèí</span>
                    Air Hockey Assistant
                </h1>
                <nav class="nav">
                    <button class="nav-btn" data-tab="game">Game Control</button>
                    <button class="nav-btn" data-tab="history">Game History</button>
                    <button class="nav-btn" data-tab="analysis">Game Analysis</button>
                                                <button class="nav-btn" data-tab="replay" style="opacity: 0.7;">Video Replay ‚ö†Ô∏è</button>
                    <button class="nav-btn" data-tab="report">Match Report</button>
                </nav>
            </div>
        </header>

        <main class="main">
            <!-- Game Control Panel -->
            <section id="game-tab" class="tab-content active">
                <div class="container">
                    <!-- Player Setup Section -->
                    <div class="player-setup">
                        <h2>üèí Game Setup</h2>
                        <div class="players-config">
                            <div class="player-config">
                                <h3>Player A</h3>
                                <div class="player-input-group">
                                    <select id="playerASelect" class="player-select">
                                        <option value="">-- Select Player A --</option>
                                    </select>
                                    <input type="text" id="playerACustom" class="player-input" placeholder="Enter custom player name" maxlength="30" style="display: none;">
                                    <button id="savePlayerA" class="btn btn-small btn-secondary" style="display: none;">üíæ Save to Database</button>
                                </div>
                            </div>
                            <div class="vs-divider">
                                <span>VS</span>
                            </div>
                            <div class="player-config">
                                <h3>Player B</h3>
                                <div class="player-input-group">
                                    <select id="playerBSelect" class="player-select">
                                        <option value="">-- Select Player B --</option>
                                    </select>
                                    <input type="text" id="playerBCustom" class="player-input" placeholder="Enter custom player name" maxlength="30" style="display: none;">
                                    <button id="savePlayerB" class="btn btn-small btn-secondary" style="display: none;">üíæ Save to Database</button>
                                </div>
                            </div>
                        </div>
                        <div class="setup-actions">
                            <button id="confirmPlayers" class="btn btn-primary">‚úÖ Confirm Players</button>
                            <button id="refreshPlayers" class="btn btn-secondary">üîÑ Refresh Players</button>
                            <span id="playersStatus" class="players-status">Please select or enter player names</span>
                        </div>
                    </div>
                    
                    <div class="game-control">
                        <h2>Game Control Panel</h2>
                        <div class="control-panel">
                            <button id="startGame" class="btn btn-primary" disabled>Start Game</button>
                            <button id="pauseGame" class="btn btn-secondary" disabled>Pause Game</button>
                            <button id="endGame" class="btn btn-danger" disabled>End Game</button>
                        </div>
                        
                        <div class="websocket-controls">
                            <h4>WebSocket Test Controls</h4>
                            <div class="test-buttons">
                                <button id="simulateGoalA" class="btn btn-export">Player A Goal</button>
                                <button id="simulateGoalB" class="btn btn-export">Player B Goal</button>
                                <button id="checkConnection" class="btn btn-secondary">Check Connection</button>
                            </div>
                        </div>
                        
                        <div class="game-status">
                            <div class="status-indicator">
                                <span class="status-label">Game Status:</span>
                                <span id="gameStatus" class="status-value">Not Started</span>
                            </div>
                            <div class="timer">
                                <span class="timer-label">Game Time:</span>
                                <span id="gameTimer" class="timer-value">00:00</span>
                            </div>
                            <div class="connection-status">
                                <span class="connection-label">Server:</span>
                                <span id="wsStatus" class="ws-status disconnected">Disconnected</span>
                            </div>
                        </div>
                    </div>

                    <div class="scoreboard">
                        <h3>Live Score</h3>
                        <div class="score-display">
                            <div class="player-score">
                                <div class="player-name">Player A</div>
                                <div class="score" id="scoreA">0</div>
                            </div>
                            <div class="vs">VS</div>
                            <div class="player-score">
                                <div class="player-name">Player B</div>
                                <div class="score" id="scoreB">0</div>
                            </div>
                        </div>
                    </div>

                    <!-- Live Stream Screen -->
                    <div class="live-stream-section">
                        <h3>üé• Live Match Stream</h3>
                        <div class="stream-container">
                            <div class="stream-screen">
                                <video id="liveStream" class="stream-video" autoplay muted playsinline>
                                    <p class="stream-fallback">Your browser does not support video streaming</p>
                                </video>
                                <div class="stream-overlay">
                                    <div class="stream-info">
                                        <div class="stream-status" id="streamStatus">
                                            <span class="stream-status-indicator offline"></span>
                                            <span class="status-text">Stream Offline</span>
                                        </div>
                                        <div class="stream-controls">
                                            <button id="connectStream" class="btn btn-primary stream-btn">
                                                <span class="btn-icon">üîó</span>
                                                Connect Camera
                                            </button>
                                            <button id="disconnectStream" class="btn btn-secondary stream-btn" disabled>
                                                <span class="btn-icon">‚èπÔ∏è</span>
                                                Disconnect
                                            </button>
                                            <button id="fullscreenStream" class="btn btn-export stream-btn" disabled>
                                                <span class="btn-icon">üîç</span>
                                                Fullscreen
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="stream-placeholder" id="streamPlaceholder">
                                    <div class="placeholder-content">
                                        <div class="placeholder-icon">üìπ</div>
                                        <h4>Camera Feed</h4>
                                        <p>Connect to Raspberry Pi camera to view live match</p>
                                        <div class="connection-info">
                                            <div class="info-item">
                                                <span class="info-label">Camera IP:</span>
                                                <input type="text" id="cameraIp" class="info-input" placeholder="192.168.1.100" value="192.168.1.100">
                                            </div>
                                            <div class="info-item">
                                                <span class="info-label">Port:</span>
                                                <input type="number" id="cameraPort" class="info-input" placeholder="8000" value="8000">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="stream-sidebar">
                                <div class="camera-stats">
                                    <h4>üìä Camera Status</h4>
                                    <div class="stats-grid">
                                        <div class="stat-item">
                                            <span class="stat-label">Resolution</span>
                                            <span class="stat-value" id="streamResolution">--</span>
                                        </div>
                                        <div class="stat-item">
                                            <span class="stat-label">FPS</span>
                                            <span class="stat-value" id="streamFps">--</span>
                                        </div>
                                        <div class="stat-item">
                                            <span class="stat-label">Bitrate</span>
                                            <span class="stat-value" id="streamBitrate">--</span>
                                        </div>
                                        <div class="stat-item">
                                            <span class="stat-label">Latency</span>
                                            <span class="stat-value" id="streamLatency">--</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="stream-settings">
                                    <h4>‚öôÔ∏è Stream Settings</h4>
                                    <div class="settings-controls">
                                        <div class="setting-item">
                                            <label>Quality</label>
                                            <select id="streamQuality" class="setting-select">
                                                <option value="high">High (720p)</option>
                                                <option value="medium" selected>Medium (480p)</option>
                                                <option value="low">Low (360p)</option>
                                            </select>
                                        </div>
                                        <div class="setting-item">
                                            <label>Auto-reconnect</label>
                                            <input type="checkbox" id="autoReconnect" class="setting-checkbox" checked>
                                        </div>
                                        <div class="setting-item">
                                            <label>Audio</label>
                                            <input type="checkbox" id="audioEnabled" class="setting-checkbox">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="live-feed">
                        <h3>Live Match Feed</h3>
                        <div id="liveFeed" class="feed-container">
                            <div class="feed-item info">
                                <div class="feed-item-icon">‚ÑπÔ∏è</div>
                                <div class="feed-item-content">
                                    <div class="feed-item-time">--:--:--</div>
                                    <div class="feed-item-message">Waiting for game to start...</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Game History -->
            <section id="history-tab" class="tab-content">
                <div class="container">
                    <h2>üéÆ Game History</h2>
                    <div class="history-controls">
                        <div class="history-toolbar">
                            <div class="info-display">
                                <span id="totalGames" class="info-item">Total Games: 0</span>
                                <span id="completedGames" class="info-item">Completed: 0</span>
                                <span id="activeGames" class="info-item">Active: 0</span>
                            </div>
                            <div class="action-controls">
                                <button id="refreshHistory" class="btn btn-secondary">üîÑ Refresh</button>
                                <button id="clearHistory" class="btn btn-danger">üóëÔ∏è Clear All</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="games-container">
                        <div id="gamesGrid" class="games-grid">
                            <div class="no-games">No games found. Start a new game to see history.</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Game Analysis -->
            <section id="analysis-tab" class="tab-content">
                <div class="container">
                    <h2>Game Analysis Dashboard</h2>
                    <div class="analysis-controls">
                        <div class="analysis-toolbar">
                            <!-- ÁÆÄÂåñ‰∏∫3‰∏™Ê†∏ÂøÉÂàÜÊûêÊ®°Âºè -->
                            <div class="analysis-modes">
                                <button class="mode-btn active" data-mode="rounds">
                                    <span class="mode-icon">üìä</span>
                                    <span class="mode-text">Round Analysis</span>
                                    <span class="mode-desc">Round-by-round timeline view</span>
                                </button>
                                <button class="mode-btn" data-mode="detailed">
                                    <span class="mode-icon">üéØ</span>
                                    <span class="mode-text">Detailed Analysis</span>
                                    <span class="mode-desc">In-depth technical analysis</span>
                                </button>
                                <button class="mode-btn" data-mode="comparison">
                                    <span class="mode-icon">‚öñÔ∏è</span>
                                    <span class="mode-text">Player Comparison</span>
                                    <span class="mode-desc">A vs B performance comparison</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="analysis-container">
                        <div id="pointBreakdown" class="point-breakdown">
                            <div class="no-data">No match data available</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Video Replay - DISABLED -->
            <section id="replay-tab" class="tab-content">
                <div class="container">
                    <h2>Video Replay & AI Analysis</h2>
                    <div class="disabled-section" style="text-align: center; padding: 50px; background: #f8f9fa; border-radius: 10px; margin: 20px 0;">
                        <div style="font-size: 4rem; margin-bottom: 20px;">üö´</div>
                        <h3 style="color: #666;">Video Replay Feature Disabled</h3>
                        <p style="color: #888; margin: 20px 0;">This feature has been disabled to reduce server requests and improve performance.</p>
                        <p style="color: #888; font-size: 0.9rem;">Focus on Game Control, Analysis, and Reports for optimal experience.</p>
                    </div>
                </div>
            </section>

            <!-- Match Report -->
            <section id="report-tab" class="tab-content">
                <div class="container">
                    <h2>Match Summary Report</h2>
                    <div class="report-container">
                        <div class="report-header">
                            <h3>Match Overview</h3>
                            <div class="export-controls">
                                <button id="exportPDF" class="btn btn-export">Export PDF</button>
                                <button id="exportExcel" class="btn btn-export">Export Excel</button>
                            </div>
                        </div>

                        <div class="report-content">
                            <div class="report-section">
                                <h4>Final Score</h4>
                                <div id="finalScore" class="final-score">
                                    <div class="score-item">
                                        <span class="player">Player A:</span>
                                        <span class="score">0</span>
                                    </div>
                                    <div class="score-item">
                                        <span class="player">Player B:</span>
                                        <span class="score">0</span>
                                    </div>
                                </div>
                            </div>

                            <div class="report-section">
                                <h4>Error Statistics</h4>
                                <div class="chart-container">
                                    <canvas id="errorChart"></canvas>
                                </div>
                            </div>

                            <div class="report-section">
                                <h4>AI Improvement Suggestions</h4>
                                <div id="aiSuggestions" class="ai-suggestions">
                                    <div class="suggestion-item">Complete a match to see AI analysis suggestions</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer class="footer">
            <div class="container">
                <p>&copy; 2024 Air_Hockey Assistant. Smart Air Hockey Training System.</p>
                <p id="playerManagerVersion" class="version-info">PlayerManager: Loading...</p>
            </div>
        </footer>
    </div>

    <script src="js/config.js"></script>
    <script src="js/websocket.js"></script>
    <script src="js/playerManagement.js"></script>
    <script src="js/app.js"></script>
    <script src="js/gameControl.js"></script>
    <script src="js/gameHistory.js"></script>
    <script src="js/analysis.js"></script>
    <script src="js/replay.js"></script> <!-- Video replay functionality disabled internally -->
    <script src="js/report.js"></script>
    <script src="js/export.js"></script>
</body>
</html> 
# 🎥 实时直播功能使用指南

## 功能概述

实时直播功能允许您在比赛页面中观看来自树莓派摄像头的实时画面，为比赛提供可视化监控。

## 主要特性

### 📹 视频流播放
- 支持多种流媒体协议（MJPEG、MP4、WebSocket）
- 自动尝试不同的连接方式
- 实时显示视频画面

### 🎛️ 控制功能
- **连接/断开**：手动控制摄像头连接
- **全屏模式**：点击按钮或按F键进入全屏
- **画质调节**：支持高清(720p)、标清(480p)、流畅(360p)三种模式
- **音频控制**：可开启/关闭音频

### 📊 实时统计
- **分辨率**：显示当前视频分辨率
- **帧率**：实时FPS监控
- **比特率**：网络传输速率
- **延迟**：连接延迟状态

### ⚙️ 智能功能
- **自动重连**：网络断开时自动尝试重新连接
- **心跳监测**：定期检查连接状态
- **状态指示**：清晰的连接状态显示

## 使用步骤

### 1. 配置摄像头地址
```
默认IP: 192.168.1.100
默认端口: 8000
```

### 2. 连接摄像头
1. 确保树莓派摄像头已启动
2. 点击"连接摄像头"按钮
3. 等待连接成功提示

### 3. 观看直播
- 视频自动播放
- 悬停显示控制按钮
- 支持全屏观看

## 键盘快捷键

- **F键**：切换全屏模式
- **ESC键**：退出全屏
- **Ctrl+C**：连接/断开摄像头

## 树莓派配置要求

### 摄像头服务端设置
您的树莓派需要运行一个流媒体服务，支持以下任一协议：

1. **MJPEG流** (推荐)
```bash
# 使用motion或mjpg-streamer
mjpg_streamer -i "input_raspicam.so" -o "output_http.so -p 8000"
```

2. **简单HTTP服务**
```bash
# 使用Python简单服务
python3 -m http.server 8000
```

3. **专用流媒体服务**
```bash
# 使用ffmpeg推流
ffmpeg -i /dev/video0 -vcodec libx264 -f flv rtmp://localhost:8000/live/stream
```

### 支持的URL格式
系统会自动尝试以下连接方式：
- `http://IP:PORT/stream.mjpg`
- `http://IP:PORT/video`
- `http://IP:PORT/stream`
- `http://IP:PORT/stream.mp4`
- `ws://IP:PORT/stream`

## 网络配置

### 防火墙设置
确保以下端口开放：
- 树莓派端口：8000 (或您设置的端口)
- 本地网络：允许HTTP/WebSocket流量

### 网络延迟优化
- 使用有线网络连接
- 确保路由器支持足够带宽
- 建议在同一局域网内使用

## 故障排除

### 连接失败
1. 检查IP地址和端口是否正确
2. 确认树莓派摄像头服务正在运行
3. 检查网络连接状态
4. 尝试不同的流媒体协议

### 视频卡顿
1. 降低画质设置
2. 检查网络带宽
3. 关闭其他网络应用
4. 调整树莓派编码参数

### 无法全屏
1. 确保浏览器支持全屏API
2. 检查是否有其他应用阻止全屏
3. 尝试使用不同浏览器

## 技术参数

### 支持的视频格式
- MJPEG
- H.264/MP4
- WebRTC (通过WebSocket)

### 推荐配置
- **分辨率**: 720p@30fps
- **比特率**: 1-3 Mbps
- **延迟**: < 200ms

### 浏览器兼容性
- Chrome 60+
- Firefox 55+
- Safari 11+
- Edge 79+

## 高级功能

### 录制功能 (计划中)
- 自动录制比赛精彩瞬间
- 手动录制控制
- 录像文件管理

### AI分析集成 (计划中)
- 实时动作识别
- 自动高光剪辑
- 智能回放建议

## 开发者信息

### 文件结构
```
Frontend/
├── js/liveStream.js          # 直播管理器
├── styles/main.css           # 样式文件
└── index.html               # 主页面
```

### 核心类
- `LiveStreamManager`: 主要的直播管理类
- 支持事件监听和状态管理
- 自动重连和错误处理

### 自定义配置
```javascript
// 修改默认设置
window.liveStreamManager.settings = {
    cameraIp: '192.168.1.100',
    cameraPort: 8000,
    quality: 'medium',
    autoReconnect: true,
    audioEnabled: false
};
```

## 更新日志

### v1.0.1
- 修复了CSS样式冲突问题，确保不影响现有游戏状态栏
- 优化了响应式设计，在不同屏幕尺寸下保持良好布局
- 改进了移动设备上的显示效果
- 增强了与现有界面的视觉一致性

### v1.0.0
- 基础直播功能
- 多协议支持
- 自动重连机制
- 全屏播放
- 实时统计监控

## 布局兼容性

✅ **不影响现有界面**
- 直播功能使用独立的CSS类名，不会与现有样式冲突
- 保持游戏状态栏的原有样式和布局
- 响应式设计确保在所有设备上都能正常显示

---

如有问题或建议，请联系开发团队。 